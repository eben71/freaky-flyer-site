---
import fs from 'node:fs';
import BaseLayout from '../../layouts/BaseLayout.astro';
import BottomCta from '../../components/BottomCta.astro';

const pageTitle = 'Our Delivery Technique | Freaky Flyer Delivery';
const pageDescription =
  'See how Freaky Flyer Delivery prepares, equalizes, and delivers every flyer bundle with GPS-backed accountability.';

const toPublicUrl = (path) =>
  new URL(`../../../public${path}`, import.meta.url);
const fileExists = (path) => {
  if (!path) return false;
  try {
    return fs.existsSync(toPublicUrl(path));
  } catch (error) {
    return false;
  }
};

const assetWithFallback = (preferred, fallback) =>
  fileExists(preferred) ? preferred : fallback;

// TODO: Replace fallback hero image once /assets/pages/technique/hero.jpg is available in the repo.
const heroImage = assetWithFallback(
  '/assets/pages/technique/hero.jpg',
  '/assets/img/optimized/flyer-delivery-services-perth-our-flyer-delivery-technique/ffdps-4-1-1280.webp'
);

const techniqueSteps = [
  {
    heading: 'FLYER DROP OFF:',
    copy: 'Our clients have the flexibility to drop off their flyers at our warehouse address in Wanneroo, or for smaller quantities only, at our 24/7 drop off location in Madeley, please ask for details. For quantities over 10,000, our friendly team can arrange FREE pick up from your business or printers location, smaller quantities can be picked up for a small fee, please ask if you require this service.',
    image: {
      // TODO: Swap to /assets/pages/technique/drop-off.jpg when the asset can be committed.
      src: assetWithFallback(
        '/assets/pages/technique/drop-off.jpg',
        '/assets/img/optimized/flyer-delivery-services-perth-our-flyer-delivery-technique/ffdps-13-1-960.webp'
      ),
      alt: 'Freaky Flyer Delivery administration manager assisting clients with flyer drop offs',
    },
  },
  {
    heading: 'PREPARATION AND EQUALIZING:',
    copy: 'Our preparation team will then organise and Equalize the flyers, using our proven Equalizing technique to ensure maximum client exposure. This all takes place at our Wanneroo warehouse, prior to delivery by our riders to ensure continuity of the delivery process.',
    image: {
      // TODO: Swap to /assets/pages/technique/preparation.jpg when the asset can be committed.
      src: assetWithFallback(
        '/assets/pages/technique/preparation.jpg',
        '/assets/img/optimized/flyer-delivery-services-perth-our-flyer-delivery-technique/ffdps-11-1-960.webp'
      ),
      alt: 'Equalizing team preparing flyer bundles inside the Wanneroo warehouse',
    },
  },
  {
    heading: 'DELIVERY:',
    copy: 'Our dedicated full time delivery riders undertake distribution using a proven professional method utilizing ex Australia Post Honda 110 Super Cub motorbikes, with front and side pannier bags, ensuring the pre-prepared and Equalized flyer bundles are delivered efficiently and effectively, no matter the weather or conditions. All of our riders are required to use our nominated GPS tracking system to ensure our clients have full confidence that the flyer delivery is undertaken to the full extent allowable under the Flyer Distribution Code of Conduct.',
    image: {
      // TODO: Swap to /assets/pages/technique/delivery-team.jpg when the asset can be committed.
      src: assetWithFallback(
        '/assets/pages/technique/delivery-team.jpg',
        '/assets/img/optimized/flyer-delivery-services-perth-our-flyer-delivery-technique/ffdps-4-1-960.webp'
      ),
      alt: 'Freaky Flyer Delivery riders and support staff gathered inside the warehouse',
    },
  },
];
---

<BaseLayout title={pageTitle} description={pageDescription}>
  <section class="flyer-hero" style={`--hero-image: url(${heroImage})`}>
    <div class="container flyer-hero__content">
      <p class="flyer-hero__eyebrow">Flyer Delivery</p>
      <h1>Our Delivery Technique</h1>
      <p>
        We call it Equalizing—an in-house process that keeps every campaign
        organised, layered, and GPS-verified so your flyers land exactly where
        they should.
      </p>
    </div>
  </section>

  <section class="section technique">
    <div class="container technique__inner">
      <div class="technique__heading">
        <h2>It’s called Equalizing, and it’s very effective</h2>
        <p>
          Every campaign follows the same accountable rhythm: simple drop off,
          meticulous Equalizing, and professional delivery. Explore how each
          step works below.
        </p>
      </div>
      <div class="technique__grid">
        {
          techniqueSteps.map((step) => (
            <article class="technique-card card">
              <div>
                <h3>{step.heading}</h3>
                <p>{step.copy}</p>
              </div>
              <figure class="technique-card__media">
                <img
                  src={step.image.src}
                  alt={step.image.alt}
                  loading="lazy"
                  decoding="async"
                />
              </figure>
            </article>
          ))
        }
      </div>
    </div>
  </section>

  <BottomCta
    text="We look forward to working with you, please contact our friendly sales team for a quote."
    href="/contact"
    label="Contact Us"
  />

  <style>
    .flyer-hero {
      color: #fff;
      background-image:
        linear-gradient(
          140deg,
          rgba(137, 4, 11, 0.92) 0%,
          rgba(76, 3, 7, 0.9) 50%,
          rgba(35, 6, 8, 0.88) 100%
        ),
        var(--hero-image, none);
      background-size: cover;
      background-position: center;
    }

    .flyer-hero__content {
      display: grid;
      gap: var(--space-4);
      padding: var(--space-16) 0;
      max-width: min(960px, 100%);
    }

    .flyer-hero__eyebrow {
      margin: 0;
      font-size: 0.95rem;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      font-weight: 700;
    }

    .technique__inner {
      display: grid;
      gap: var(--space-10);
    }

    .technique__heading {
      max-width: 800px;
    }

    .technique__heading h2 {
      margin-bottom: var(--space-4);
    }

    .technique__grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: var(--space-6);
    }

    .technique-card {
      display: flex;
      flex-direction: column;
      gap: var(--space-4);
      min-height: 100%;
    }

    .technique-card h3 {
      margin: 0 0 var(--space-3);
      font-size: 1rem;
      letter-spacing: 0.18em;
      text-transform: uppercase;
    }

    .technique-card__media {
      margin: 0;
    }

    .technique-card__media img {
      width: 100%;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }

    @media (max-width: 900px) {
      .technique__grid {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 640px) {
      .flyer-hero__content {
        text-align: center;
      }

      .technique-card {
        text-align: left;
      }
    }
  </style>
</BaseLayout>
