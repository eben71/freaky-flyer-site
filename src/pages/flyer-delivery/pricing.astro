---
import fs from 'node:fs';
import BaseLayout from '../../layouts/BaseLayout.astro';
import BottomCta from '../../components/BottomCta.astro';

const pageTitle = 'Pricing | Freaky Flyer Delivery';
const pageDescription =
  'Flyer delivery pricing varies by quantity, targeting, and add-ons—get transparent guidance and download the latest rate card.';

const toPublicUrl = (path) =>
  new URL(`../../../public${path}`, import.meta.url);
const fileExists = (path) => {
  if (!path) return false;
  try {
    return fs.existsSync(toPublicUrl(path));
  } catch (error) {
    return false;
  }
};

const assetWithFallback = (preferred, fallback) =>
  fileExists(preferred) ? preferred : fallback;

// TODO: Replace fallback hero image once /assets/pages/pricing/hero.jpg is available in the repo.
const heroImage = assetWithFallback(
  '/assets/pages/pricing/hero.jpg',
  '/assets/img/optimized/flyer-delivery-services-perth-our-flyer-delivery-technique/ffdps-4-1-1280.webp'
);

const priceListHref = fileExists('/downloads/pricing.pdf')
  ? '/downloads/pricing.pdf'
  : '/contact';
const isDownload = priceListHref.startsWith('/downloads/');
---

<BaseLayout title={pageTitle} description={pageDescription}>
  <section class="flyer-hero" style={`--hero-image: url(${heroImage})`}>
    <div class="container flyer-hero__content">
      <p class="flyer-hero__eyebrow">Flyer Delivery</p>
      <h1>Pricing</h1>
      <p>
        Pricing depends on your flyer size, targeted suburbs, and monthly
        frequency. Our team will guide you through the right mix so every dollar
        works hard.
      </p>
    </div>
  </section>

  <section class="section pricing">
    <div class="container pricing__inner">
      <div class="pricing__lede card">
        <p class="pricing__intro">
          Every campaign is unique—quantities, bundling preferences, and
          reporting options all influence the final cost. Review our latest
          price list below and reach out if you would like personalised advice.
        </p>
        <div class="pricing__actions">
          <a
            class="button primary button--pill"
            href={priceListHref}
            download={isDownload ? '' : undefined}
            aria-label="View Full Price List"
          >
            <span class="button__icon" aria-hidden="true">
              <svg
                viewBox="0 0 24 24"
                role="img"
                aria-hidden="true"
                focusable="false"
              >
                <path
                  fill="currentColor"
                  d="M6 3h12a2 2 0 0 1 2 2v14c0 1.1-.9 2-2 2H6a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2zm0 2v14h12V5H6zm2 2h8v2H8V7zm0 4h8v2H8v-2zm0 4h5v2H8v-2z"
                ></path>
              </svg>
            </span>
            <span>View Full Price List</span>
          </a>
          <a class="button outline button--pill" href="/contact">Contact Us</a>
        </div>
      </div>
    </div>
  </section>

  <BottomCta
    text="We look forward to working with you, please contact our friendly sales team for a quote."
    href="/contact"
    label="Contact Us"
  />

  <style>
    .flyer-hero {
      color: #fff;
      background-image:
        linear-gradient(
          140deg,
          rgba(137, 4, 11, 0.92) 0%,
          rgba(76, 3, 7, 0.9) 50%,
          rgba(35, 6, 8, 0.88) 100%
        ),
        var(--hero-image, none);
      background-size: cover;
      background-position: center;
    }

    .flyer-hero__content {
      display: grid;
      gap: var(--space-4);
      padding: var(--space-16) 0;
      max-width: min(960px, 100%);
    }

    .flyer-hero__eyebrow {
      margin: 0;
      font-size: 0.95rem;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      font-weight: 700;
    }

    .pricing__inner {
      display: grid;
      gap: var(--space-8);
    }

    .pricing__lede {
      display: grid;
      gap: var(--space-6);
    }

    .pricing__intro {
      margin: 0;
      font-size: 1.15rem;
      line-height: 1.8;
      color: var(--muted);
    }

    .pricing__actions {
      display: flex;
      flex-wrap: wrap;
      gap: var(--space-4);
    }

    .button--pill {
      border-radius: 999px;
      padding-inline: 28px;
      min-height: 52px;
    }

    .button__icon {
      display: inline-flex;
      width: 1.2em;
      height: 1.2em;
    }

    .button__icon svg {
      width: 100%;
      height: 100%;
    }

    @media (max-width: 640px) {
      .flyer-hero__content {
        text-align: center;
      }

      .pricing__actions {
        flex-direction: column;
      }

      .pricing__actions .button {
        width: 100%;
        justify-content: center;
      }
    }
  </style>
</BaseLayout>
