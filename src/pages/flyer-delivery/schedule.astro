---
import fs from 'node:fs';
import BaseLayout from '../../layouts/BaseLayout.astro';
import BottomCta from '../../components/BottomCta.astro';

const pageTitle = 'Delivery Schedule | Freaky Flyer Delivery';
const pageDescription =
  'Review Freaky Flyer Delivery’s standard run cadence across Perth suburbs and download the full delivery schedule.';

const toPublicUrl = (path) =>
  new URL(`../../../public${path}`, import.meta.url);
const fileExists = (path) => {
  if (!path) return false;
  try {
    return fs.existsSync(toPublicUrl(path));
  } catch (error) {
    return false;
  }
};

const assetWithFallback = (preferred, fallback) =>
  fileExists(preferred) ? preferred : fallback;

// TODO: Replace fallback hero image once /assets/pages/schedule/hero.jpg is available in the repo.
const heroImage = assetWithFallback(
  '/assets/pages/schedule/hero.jpg',
  '/assets/img/optimized/flyer-delivery-services-perth-https-freakyflyerdelivery-com-au-copy-of-ffd-delivery-schedule-8/ffdps-22-1-2-1280.webp'
);

// TODO: Replace fallback portrait once /assets/pages/schedule/team.jpg is available in the repo.
const scheduleImage = assetWithFallback(
  '/assets/pages/schedule/team.jpg',
  '/assets/img/optimized/flyer-delivery-services-perth-https-freakyflyerdelivery-com-au-copy-of-ffd-delivery-schedule-8/ffdps-22-1-1-960.webp'
);

const scheduleHref = fileExists('/downloads/FFD-DELIVERY-SCHEDULE.pdf')
  ? '/downloads/FFD-DELIVERY-SCHEDULE.pdf'
  : '/contact';
const scheduleIsDownload = scheduleHref.startsWith('/downloads/');

const scheduleCopy =
  'Freaky Flyer Delivery currently distributes to 500,000+ residential homes, encompassing 240+ metropolitan suburbs, within the greater Perth region. Our delivery schedule is undertaken on a first come first served basis, meaning that at this point in time we cannot physically undertake all suburbs every month, so the earlier you request a delivery each month will result in a greater chance of being undertaken, regular monthly deliveries will always take priority, so get that plan in place to ensure continuity of delivery each month. We will always try to accommodate any requests as best we can to suit our clients and as we grow, our aim is to deliver to every listed suburb, every month.';
---

<BaseLayout title={pageTitle} description={pageDescription}>
  <section class="flyer-hero" style={`--hero-image: url(${heroImage})`}>
    <div class="container flyer-hero__content">
      <p class="flyer-hero__eyebrow">Flyer Delivery</p>
      <h1>Delivery Schedule</h1>
      <p>
        Our riders cover Perth’s north and south corridors every week. Use the
        published schedule to reserve the suburbs you need before they fill up.
      </p>
    </div>
  </section>

  <section class="section schedule">
    <div class="container schedule__inner">
      <div class="schedule__content">
        <h2>Our standard delivery schedule</h2>
        <p class="schedule__subheading">
          incorporating 'Residential' flyer delivery
        </p>
        <p>{scheduleCopy}</p>
        <a
          class="button primary button--pill schedule__button"
          href={scheduleHref}
          download={scheduleIsDownload ? '' : undefined}
        >
          <span class="button__icon" aria-hidden="true">
            <svg
              viewBox="0 0 24 24"
              role="img"
              aria-hidden="true"
              focusable="false"
            >
              <path
                fill="currentColor"
                d="M7 2h10a3 3 0 0 1 3 3v15a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V5a3 3 0 0 1 3-3zm10 2H7a1 1 0 0 0-1 1v1h12V5a1 1 0 0 0-1-1zm-6 9H6v2h5v-2zm0 4H6v2h5v-2zm7-4h-5v2h5v-2zm0 4h-5v2h4a1 1 0 0 0 1-1v-1zm-7-8H6v2h5V9zm7 0h-5v2h5V9zM9 3h2v3H9V3zm4 0h2v3h-2V3z"
              ></path>
            </svg>
          </span>
          <span>View Full Delivery Schedule</span>
        </a>
      </div>
      <figure class="schedule__media">
        <img
          src={scheduleImage}
          alt="Freaky Flyer Delivery team smiling inside the warehouse"
          loading="lazy"
          decoding="async"
        />
      </figure>
    </div>
  </section>

  <BottomCta
    text="We look forward to working with you, please contact our friendly sales team for a quote."
    href="/contact"
    label="Contact Us"
  />

  <style>
    .flyer-hero {
      color: #fff;
      background-image:
        linear-gradient(
          140deg,
          rgba(137, 4, 11, 0.92) 0%,
          rgba(76, 3, 7, 0.9) 50%,
          rgba(35, 6, 8, 0.88) 100%
        ),
        var(--hero-image, none);
      background-size: cover;
      background-position: center;
    }

    .flyer-hero__content {
      display: grid;
      gap: var(--space-4);
      padding: var(--space-16) 0;
      max-width: min(960px, 100%);
    }

    .flyer-hero__eyebrow {
      margin: 0;
      font-size: 0.95rem;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      font-weight: 700;
    }

    .schedule__inner {
      display: grid;
      gap: var(--space-8);
      grid-template-columns: repeat(2, minmax(0, 1fr));
      align-items: center;
    }

    .schedule__content {
      display: grid;
      gap: var(--space-4);
    }

    .schedule__subheading {
      margin: 0;
      font-size: 1rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--muted);
    }

    .schedule__content p {
      margin: 0;
      line-height: 1.8;
    }

    .schedule__button {
      justify-self: start;
    }

    .button--pill {
      border-radius: 999px;
      padding-inline: 28px;
      min-height: 52px;
    }

    .button__icon {
      display: inline-flex;
      width: 1.2em;
      height: 1.2em;
    }

    .button__icon svg {
      width: 100%;
      height: 100%;
    }

    .schedule__media {
      margin: 0;
    }

    .schedule__media img {
      width: 100%;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }

    @media (max-width: 900px) {
      .schedule__inner {
        grid-template-columns: 1fr;
      }

      .schedule__button {
        width: 100%;
        justify-content: center;
      }
    }

    @media (max-width: 640px) {
      .flyer-hero__content {
        text-align: center;
      }

      .schedule__subheading {
        text-align: left;
      }
    }
  </style>
</BaseLayout>
