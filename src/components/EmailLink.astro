---
import { Fragment } from 'astro/jsx-runtime';

/**
 * Usage: <EmailLink user="admin" domain="freakyflyerdelivery.com.au">Email us</EmailLink>
 * Renders a clickable email without exposing a raw "mailto:" in HTML source.
 */
const { user = '', domain = '' } = Astro.props ?? {};
const fallback = `${user}@${domain}`;
const slotContent = Astro.slots.default
  ? (await Astro.slots.default()).trim()
  : '';
const display = slotContent.length > 0 ? slotContent : fallback;
const obfuscated = fallback.replace('@', '&#64;');
const innerHtml = display === fallback ? obfuscated : display;
const handleClick = `(e)=>{e.preventDefault();window.location.href='mailto:'+'${user}'+'@'+'${domain}'}`;
---

<a href="#" aria-label="Email link" onClick={handleClick}>
  <Fragment set:html={innerHtml} />
</a>
